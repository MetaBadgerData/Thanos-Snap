---
title: "Thanos-Snap Project"
output: word_document
date: "2023-03-31"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Section One

```{r kayla}

```


## Section Two

```{r sophie}

```

## Section Three

```{r White}
#Link to github repo: https://github.com/rstudio/shiny-examples/blob/main/001-hello/app.R
library(shiny)
library(shinythemes)

ui <- fluidPage(
  theme = shinytheme("superhero"),
  titlePanel("Thanos Snap!"),
  
  sidebarLayout(
    sidebarPanel(
      numericInput("popInput", "Set Population:", value = 50, min = 1),
      br(),
      actionButton("growButton", "GROW"),
      actionButton("stopButton", "STOP"),
      actionButton("goButton", "SNAP!")
    ),
    
    mainPanel(
      plotOutput("bottleneckPlot", height = "400px"),
      br(),
      textOutput("nText")
    )
  )
)

server <- function(input, output, session) {
  # Reactive values
  population <- reactiveVal(50)
  history <- reactiveVal(c(50))
  growing <- reactiveVal(FALSE)
  max_pop <- reactiveVal(50)
  
  # Timer for continuous growth
  observe({
    if (growing()) {
      invalidateLater(200, session)  # Update every 200ms for smooth growth
      isolate({
        current_pop <- population()
        new_pop <- current_pop * 1.05
        population(new_pop)
        
        # Update max population if needed
        if (new_pop > max_pop()) {
          max_pop(new_pop)
        }
        
        # Update history
        new_history <- c(history(), new_pop)
        if (length(new_history) > 100) {
          new_history <- tail(new_history, 100)
        }
        history(new_history)
      })
    }
  })
  
  # Event observers
  observeEvent(input$popInput, {
    population(input$popInput)
    history(c(input$popInput))
    max_pop(input$popInput)
  })
  
  observeEvent(input$growButton, {
    growing(TRUE)
  })
  
  observeEvent(input$stopButton, {
    growing(FALSE)
  })
  
  observeEvent(input$goButton, {
    growing(FALSE)
    new_pop <- max(1, round(population() / 2))
    population(new_pop)
    new_history <- c(history(), new_pop)
    if (length(new_history) > 100) {
      new_history <- tail(new_history, 100)
    }
    history(new_history)
  })
  
  # Outputs
  output$nText <- renderText({
    paste("Current Population:", round(population()))
  })
  
  output$bottleneckPlot <- renderPlot({
    pops <- history()
    gens <- 1:length(pops)
    
    # Set up plot area
    par(bg = "#2C3E50", fg = "white", col.main = "white", 
        col.lab = "white", col.axis = "white")
    
    plot(gens, pops, type = "n",
         xlab = "Time Step", ylab = "Population",
         main = "Population Dynamics: Thanos Snap!",
         ylim = c(0, max_pop() * 1.1),
         xlim = c(1, max(10, length(pops))),
         cex.main = 1.2, cex.lab = 1.1, font.main = 2)
    
    # Add grid
    grid(col = "gray30", lty = 3)
    
    # Fill area under curve
    polygon(c(gens, rev(gens)), c(pops, rep(0, length(pops))),
            col = adjustcolor("lightgreen", alpha.f = 0.6),
            border = NA)
    
    # Add line
    lines(gens, pops, type = "l", lwd = 3, col = "#27AE60")
    
    # Add points
    points(gens, pops, pch = 21, bg = "#2ECC71", col = "white", cex = 1.2)
    
    # Highlight current point
    if (length(pops) > 0) {
      points(length(pops), tail(pops, 1), pch = 21, bg = "red", 
             col = "white", cex = 2, lwd = 2)
    }
    
    # Add legend
    legend("topright", 
           legend = c("Population", "Current"),
           pch = c(21, 21),
           pt.bg = c("#2ECC71", "red"),
           col = c("white", "white"),
           pt.cex = c(1.2, 2),
           bg = adjustcolor("#34495E", alpha.f = 0.8),
           box.col = "white")
  })
}

shinyApp(ui = ui, server = server)
```



## Section Four

```{r student4}

```